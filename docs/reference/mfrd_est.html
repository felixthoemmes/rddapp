<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="mfrd_est implements the frontier approach for multivariate regression discontinuity estimation in Wong, Steiner and Cook (2013). 
It is based on the MFRDD code in Stata from Wong, Steiner, and Cook (2013)."><title>Multivariate Frontier Regression Discontinuity Estimation — mfrd_est • rddapp</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multivariate Frontier Regression Discontinuity Estimation — mfrd_est"><meta property="og:description" content="mfrd_est implements the frontier approach for multivariate regression discontinuity estimation in Wong, Steiner and Cook (2013). 
It is based on the MFRDD code in Stata from Wong, Steiner, and Cook (2013)."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rddapp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/rddapp.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/distance-from-frontier.html">Measuring distances from the frontier</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Multivariate Frontier Regression Discontinuity Estimation</h1>
      
      <div class="d-none name"><code>mfrd_est.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>mfrd_est</code> implements the frontier approach for multivariate regression discontinuity estimation in Wong, Steiner and Cook (2013). 
It is based on the MFRDD code in Stata from Wong, Steiner, and Cook (2013).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">mfrd_est</span><span class="op">(</span>
  <span class="va">y</span>,
  <span class="va">x1</span>,
  <span class="va">x2</span>,
  <span class="va">c1</span>,
  <span class="va">c2</span>,
  t.design <span class="op">=</span> <span class="cn">NULL</span>,
  local <span class="op">=</span> <span class="fl">0.15</span>,
  front.bw <span class="op">=</span> <span class="cn">NA</span>,
  m <span class="op">=</span> <span class="fl">10</span>,
  k <span class="op">=</span> <span class="fl">5</span>,
  kernel <span class="op">=</span> <span class="st">"triangular"</span>,
  ngrid <span class="op">=</span> <span class="fl">250</span>,
  margin <span class="op">=</span> <span class="fl">0.03</span>,
  boot <span class="op">=</span> <span class="cn">NULL</span>,
  cluster <span class="op">=</span> <span class="cn">NULL</span>,
  stop.on.error <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>y</dt>
<dd><p>A numeric object containing outcome variable.</p></dd>
<dt>x1</dt>
<dd><p>A numeric object containing the first assignment variable.</p></dd>
<dt>x2</dt>
<dd><p>A numeric object containing the second assignment variable.</p></dd>
<dt>c1</dt>
<dd><p>A numeric value containing the cutpoint at which assignment to the treatment is determined for <code>x1</code>.</p></dd>
<dt>c2</dt>
<dd><p>A numeric value containing the cutpoint at which assignment to the treatment is determined for <code>x2</code>.</p></dd>
<dt>t.design</dt>
<dd><p>A character vector of length 2 specifying the treatment option according to design.
The first entry is for <code>x1</code> and the second entry is for <code>x2</code>. Options are  
<code>"g"</code> (treatment is assigned if <code>x1</code> is greater than its cutoff),
<code>"geq"</code> (treatment is assigned if <code>x1</code> is greater than or equal to its cutoff),
<code>"l"</code> (treatment is assigned if <code>x1</code> is less than its cutoff),
and <code>"leq"</code> (treatment is assigned if <code>x1</code> is less than or equal to its cutoff).
The same options are available for <code>x2</code>.</p></dd>
<dt>local</dt>
<dd><p>A non-negative numeric value specifying the range of neighboring points around the cutoff on the 
standardized scale, for each assignment variable. The default is 0.15.</p></dd>
<dt>front.bw</dt>
<dd><p>A non-negative numeric vector of length 3 specifying the bandwidths at which to estimate the RD for each
of three effects models (complete model, heterogeneous treatment model, and treatment only model) 
detailed in Wong, Steiner, and Cook (2013).
If <code>NA</code>, <code>front.bw</code> will be determined by cross-validation. The default is <code>NA</code>.</p></dd>
<dt>m</dt>
<dd><p>A non-negative integer specifying the number of uniformly-at-random samples to draw as search candidates for <code>front.bw</code>,
if <code>front.bw</code> is <code>NA</code>. The default is 10.</p></dd>
<dt>k</dt>
<dd><p>A non-negative integer specifying the number of folds for cross-validation to determine <code>front.bw</code>,
if <code>front.bw</code> is <code>NA</code>. The default is 5.</p></dd>
<dt>kernel</dt>
<dd><p>A string indicating which kernel to use. Options are <code>"triangular"</code> 
(default and recommended), <code>"rectangular"</code>, <code>"epanechnikov"</code>, <code>"quartic"</code>, 
<code>"triweight"</code>, <code>"tricube"</code>, and <code>"cosine"</code>.</p></dd>
<dt>ngrid</dt>
<dd><p>A non-negative integer specifying the number of non-zero grid points on each assignment variable,
which is also the number of zero grid points on each assignment variable. The default is 250. The value used in 
Wong, Steiner and Cook (2013) is 2500, which may cause long computational time.</p></dd>
<dt>margin</dt>
<dd><p>A non-negative numeric value specifying the range of grid points beyond the minimum and maximum
of sample points on each assignment variable. This grid is used to impute potential outcomes along the frontier,
as in Wong, Steiner, and Cook (2013). The default is 0.03.</p></dd>
<dt>boot</dt>
<dd><p>An optional non-negative integer specifying the number of bootstrap samples to obtain standard error of estimates.</p></dd>
<dt>cluster</dt>
<dd><p>An optional vector of length n specifying clusters within which the errors are assumed
to be correlated. This will result in reporting cluster robust SEs. It is suggested that data with a discrete running 
variable be clustered by each unique value of the running variable (Lee and Card, 2008).</p></dd>
<dt>stop.on.error</dt>
<dd><p>A logical value indicating whether to remove bootstraps which cause error in the <code>integrate</code> function. If <code>TRUE</code>, bootstraps which cause error are removed
and resampled until the specified number of 
bootstrap samples are acquired. If <code>FALSE</code>, bootstraps which cause error are not removed. The default is <code>TRUE</code>.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>mfrd_est</code> returns an object of <a href="https://rdrr.io/r/base/class.html" class="external-link">class</a> "<code>mfrd</code>".
  The functions <code>summary</code> and <code>plot</code> are used to obtain and print a summary and 
  plot of the estimated regression discontinuity. The object of class <code>mfrd</code> is a list 
  containing the following components:</p>
<dl><dt>w</dt>
<dd><p>Numeric vector specifying the weight of frontier 1 and frontier 2, respectively.</p></dd>
<dt>est</dt>
<dd><p>Numeric matrix of the estimate of the discontinuity in the outcome under 
  a complete model (no prefix), heterogeneous treatment (ht) effects model, and treatment (t) only model,
  for the parametric case and for each corresponding bandwidth.
  Estimates with suffix "ev1" and "ev2" correspond to expected values for each frontier, under a given model.
  Estimates with suffix "ate" correspond to average treatment effects across both frontiers, 
  under a given model.</p></dd>
<dt>d</dt>
<dd><p>Numeric matrix of the effect size (Cohen's d) for estimate.</p></dd>
<dt>se</dt>
<dd><p>Numeric matrix of the standard error for each corresponding bandwidth and ....</p></dd>
<dt>m_s</dt>
<dd><p>A list containing estimates for the complete model, under parametric
and non-parametric (optimal, half, and double bandwidth) cases. A list of 
coefficient estimates, residuals, effects, weights (in the non-parametric case),
<code>lm</code> output (rank of the fitted linear model, fitted values, assignments for the design matrix,
qr for linear fit, residual degrees of freedom, levels of the x value, function call, and terms),
and output data frame are returned for each model.</p></dd>
<dt>m_h</dt>
<dd><p>A list containing estimates for the heterogeneous treatments model, under parametric
and non-parametric (optimal, half, and double bandwidth) cases. A list of 
coefficient estimates, residuals, effects, weights (in the non-parametric case),
<code>lm</code> output (rank of the fitted linear model, fitted values, assignments for the design matrix,
qr for linear fit, residual degrees of freedom, levels of the x value, function call, and terms),
and output data frame are returned for each model.</p></dd>
<dt>m_t</dt>
<dd><p>A list containing estimates for the treatment only model, under parametric
and non-parametric (optimal, half, and double bandwidth) cases. A list of 
coefficient estimates, residuals, effects, weights (in the non-parametric case),
<code>lm</code> output (rank of the fitted linear model, fitted values, assignments for the design matrix,
qr for linear fit, residual degrees of freedom, levels of the x value, function call, and terms),
and output data frame are returned for each model.</p></dd>
<dt>dat_h</dt>
<dd><p>A list containing four data frames, one for each case:
parametric or non-parametric (optimal, half, and double bandwidth).
Each data frame contains functions and densities for each frontier
and treatment model.</p></dd>
<dt>dat</dt>
<dd><p>A data frame containing the outcome (<code>y</code>) and each input
(<code>x1</code>, <code>x2</code>) for each observation. The data frame also contains
 indicators of being within the <code>local</code> boundary of the <code>cutpoint</code>
 for x1 and x2 (<code>x1res</code>, <code>x2res</code>),
scaled (<code>zx1</code>, <code>zx2</code>) and
centered x1 and x2 values (<code>zcx1</code>, <code>zcx2</code>), and 
treatment indicators for overall treatment (<code>tr</code>) based on treatment assignment
from x1 (<code>tr1</code>), x2 (<code>tr2</code>), and both assignment variables (<code>trb</code>).</p></dd>
<dt>obs</dt>
<dd><p>List of the number of observations used in each model.</p></dd>
<dt>impute</dt>
<dd><p>A logical value indicating whether multiple imputation is used or not.</p></dd>
<dt>call</dt>
<dd><p>The matched call.</p></dd>
<dt>front.bw</dt>
<dd><p>Numeric vector of each bandwidth used to estimate the density
  at the frontier for the three effects models (complete model,
  heterogeneous treatment model, and treatment only model) 
  detailed in Wong, Steiner, and Cook (2013).</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Wong, V., Steiner, P, and Cook, T. (2013).
  Analyzing regression discontinuity designs with multiple assignment variables: A comparative study of four estimation methods. 
  Journal of Educational and Behavioral Statistics, 38(2), 107-141. 
  doi: <a href="https://doi.org/10.3102/1076998611432172" class="external-link">10.3102/1076998611432172</a>
.</p>
<p>Lee, D. and Card, D. (2008).
  A Regression discontinuity inference with specification error.
  Journal of Econometrics, 142(2), 655-674. 
  doi: <a href="https://doi.org/10.1016/j.jeconom.2007.05.003" class="external-link">10.1016/j.jeconom.2007.05.003</a>
.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span class="r-in"><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span>
<span class="r-in"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">x1</span> <span class="op">&gt;=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">cov</span> <span class="op">+</span> <span class="fl">10</span> <span class="op">*</span> <span class="op">(</span><span class="va">x2</span> <span class="op">&gt;=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">mfrd_est</span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span>, c1 <span class="op">=</span> <span class="fl">0</span>, c2 <span class="op">=</span> <span class="fl">0</span>, t.design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"geq"</span>, <span class="st">"geq"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mfrd_est(y = y, x1 = x1, x2 = x2, c1 = 0, c2 = 0, t.design = c("geq", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     "geq"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ev1     ev2     ate     htev1   htev2   htate   tev1    tev2  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Param       2.062   9.903   6.442   2.375  10.486   6.906   4.563   4.563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bw          1.979   9.574   6.221   2.257  10.294   6.746   5.930   5.930</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Half-bw     1.712   8.876   5.714   2.066  10.013   6.505   5.803   5.803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Double-bw   2.038   9.765   6.354   2.324  10.400   6.835   5.508   5.508</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            tate  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Param       4.563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bw          5.930</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Half-bw     5.803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Double-bw   5.508</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Ze Jin, Wang Liao, Irena Papst, Wenyu Zhang, Kimberly Hochstedler, Felix Thoemmes.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer></div>

  

  

  </body></html>

