#
set.seed(12345)

## power

# sharp
rddapp::mrd_power(num.rep = 1000, sample.size = 1000)

# success mean(est)    var(est) 0.001 0.01 0.05
# Linear    1000  1.611713 0.003029843     1    1    1
# Opt       1000  1.598205 0.004520707     1    1    1
# Linear    1000  1.577906 0.004674266     1    1    1
# Opt       1000  1.579614 0.006447620     1    1    1
# Linear    1000  1.579858 0.004455947     1    1    1
# Opt       1000  1.579917 0.006723874     1    1    1

# one fuzzy
rddapp::mrd_power(num.rep = 1000, sample.size = 1000, 
                  x1.fuzzy = c(0.2, 0.2))

# success mean(est)    var(est) 0.001 0.01 0.05
# Linear    1000  1.677804 0.006374767     1    1    1
# Opt       1000  1.675217 0.009539402     1    1    1
# Linear    1000  1.574279 0.013528431     1    1    1
# Opt       1000  1.571784 0.018542337     1    1    1
# Linear    1000  1.723280 0.008235597     1    1    1
# Opt       1000  1.722047 0.011789443     1    1    1

# two fuzzy
rddapp::mrd_power(num.rep = 1000, sample.size = 1000, 
                  x1.fuzzy = c(0.2, 0.2), x2.fuzzy = c(0.2, 0.2))

# success mean(est)   var(est) 0.001  0.01 0.05
# Linear    1000  1.718001 0.01476049 1.000 1.000    1
# Opt       1000  1.728715 0.02176011 1.000 1.000    1
# Linear    1000  1.726967 0.02406806 1.000 1.000    1
# Opt       1000  1.722521 0.03244015 0.997 0.998    1
# Linear    1000  1.722733 0.02800247 1.000 1.000    1
# Opt       1000  1.716740 0.03780096 0.997 0.999    1

